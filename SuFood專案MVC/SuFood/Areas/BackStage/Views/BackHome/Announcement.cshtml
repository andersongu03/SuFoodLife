@section Styles{
	<link href="~/css/announcement.css" rel="stylesheet" />
	<script src="https://cdn.jsdelivr.net/npm/vue/dist/vue.js"></script>
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-vue@2.21.2/dist/bootstrap-vue.min.css">
	<script src="https://cdn.jsdelivr.net/npm/bootstrap-vue@2.21.2/dist/bootstrap-vue.min.js"></script>
	<script src="https://kit.fontawesome.com/6643c6516c.js" crossorigin="anonymous"></script>
	<script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
}
<style>
	.general_order_table {
		border-bottom: 1px solid;
		background: #4f8180;
		color: #fff;
		font-weight: bold;
	}

	#ordersDetailModal {
		color: rgb(242 191 15);
		font-weight: bold;
	}

	.modal-header #recyledetailsModal {
		color: rgb(248 119 17);
		font-weight: bold;
	}

	.time-button {
		border: none;
		display: inline-block;
		background-color: hsl(120, 100%, 25%);
		color: #fff;
		padding: 1rem 1.25rem;
		border-radius: .5rem;
		transition: .3s;
		width: 20%;
		height: 20%;
		box-shadow: 0 2px 4px rgba(0, 0, 0, .3);
	}

</style>
<main id="app">
	<header>
		<nav>
			<ul>
				<li v-for="(tab, tabName) in tabs" :key="tabName">
					<button class="tab"
							@@click="setTabActive(tabName, selectedType)"
							:class="{'active': tabName === activeTab}">
						<span class="tab-copy">{{ tabName }}</span>
						<span class="tab-background">
							<span class="tab-rounding left"></span>
							<span class="tab-rounding right"></span>
						</span>
					</button>
				</li>
			</ul>
		</nav>
	</header>
	<article>
		<div class="container">
			<div>
				<transition name="fade"
							mode="out-in"
							appear
							:duration="500">
					@*<keep-alive>*@
					<tabcontent v-for="(tabContent, t) in tabs"
								:data="tabContent"
								:key="'content'+t"
								v-if="t === activeTab"
								inline-template>
						<template>
							<div class="tabContent orders-container col-12">
								<!-- 内容 -->
								<div class="row mb-3">
									<div class="col-5">
										<div >
											<button  class="time-button" type="button" @@click="CreateAA()" class="btn btn-outline-success" data-bs-toggle="modal" data-bs-target="#staticBackdrop">新增</button>
										</div>
									</div>
									
									<div class="col-3">
										<div class="searchBar">
											<div class="inputWrapper">
												<i class='bx bx-search-alt-2 searchIcon'></i>
												<input type="text" class="inputSearch" placeholder="Search..." v-model="keyword" @@input="GetSearchDetail" />
											</div>
										</div>
									</div>
								</div>
								<div class="table">								
									<table class="table table-hover">
										<thead class="general_order_table">
											<tr>
												<th>ID</th>
												<th>圖片</th>
												<th>內容</th>
												<th>建立時間</th>
												<th>建立者</th>
												<th>狀態</th>
												<th>編輯</th>
												<th>刪除</th>
											</tr>
										</thead>
										<tbody>
											<tr v-for="item in filteredAnnouncementes" :key="item.announcementId">
												<template v-if="item.changeEdit == true">
													
												</template>
												<template v-else="item.changeEdit == false">
													<td class="align-middle">
														<span>{{item.announcementId}}</span>
													</td>
													<td class="align-middle">
														<img :src="'data:image/jpeg;base64,'+item.announcementImage" class="AnnouncementImage" width="300px">
													</td>
													<td class="align-middle">
														<span>{{item.announcementContent}}</span>
													</td>
													<td class="align-middle">
														<span>{{(item.announcementStartDate).split("T").join(" ").slice(0,19)}}</span>
													</td>												
													<td class="align-middle">
														<span>{{item.announcementCreater}}</span>
													</td>	
													<td class="align-middle">
														<span :id="item.announcementStatus == true? 'Statuson' : 'Statusoff'">{{item.announcementStatus == true ? "上架中" :"未上架"}}</span>
													</td>
													<td class="align-middle">
														<i class="fa-solid fa-pen-to-square  fa-2x" style="color: #1239fd;" data-bs-toggle="modal" data-bs-target="#editModal" @@click="EditAA(item)"></i>
													</td>
													<td class="align-middle">
														<i class="fa-solid fa-trash-can  fa-2x" style="color: #bd0013;" @@click="DeleteAnnouncement(item.announcementId)"></i>
													</td>
												</template>
											</tr>
										</tbody>
									</table>
								</div>
								<!-- 内容 -->
							</div>
						</template>
					</tabcontent>
					@*	</keep-alive>*@
				</transition>
			</div>
		</div>
	</article>


	@* 彈出的視窗*@
	<!-- EditModal -->
	<div class="modal fade" id="editModal" data-bs-backdrop="static" data-bs-keyboard="false" tabindex="-1" aria-labelledby="staticBackdropLabel" aria-hidden="true">
		<div class="modal-dialog modal-xl modal-dialog-centered">
			<div class="modal-content">
				<div class="modal-header">
					<h1 class="modal-title fs-5" id="staticBackdropLabel">編輯</h1>
					<button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
				</div>
				<div class="modal-body container text-center">
					<div class="row row-cols-lg-auto g-4 align-items-center">
						<div class="col-2 input-group-text">
							ID : {{EditInfo.id}}
						</div>
						<div class="col-3">
							<div class="input-group">
								<div class="input-group-text">類型選擇:</div>
								<select name="Type" class="form-control form-control-lg" aria-label=".form-control-lg example" v-model="EditInfo.Type">
									<option value="首頁">首頁</option>
									<option>輪播圖</option>
									<option>優惠公告</option>
									<option>熱賣</option>
								</select>
							</div>
						</div>
						<div class="col-3">
							<div class="input-group">
								<div class="input-group-text">內容描述:</div>
								<input name="Context" class="form-control form-control-lg" type="text" placeholder="輸入內容" aria-label=".form-control-lg example" v-model="EditInfo.Context">
							</div>
						</div>
						<div class="col-2">
							<label class="input-group-text form-check-label" for="flexSwitchCheckDefault">切換上下架:</label>
						</div>
						<div class="col-2">
							<div class="form-check form-switch">
								<input class="form-check-input" type="checkbox" role="switch" id="flexSwitchCheckDefault" v-model="EditInfo.Status" style="transform: scale(2)">
							</div>
						</div>
						<div class="col-2">
							<div class="input-group">
								<div class="input-group-text">建立者:</div>
								<input name="Context" class="form-control form-control-lg" type="text" placeholder="輸入管理員名稱" aria-label=".form-control-lg example" v-model="EditInfo.Creator">
							</div>
						</div>
						<div class="col-3">
							<div class="input-group">
								<label class="input-group-text" name="Img">上傳圖片:</label>
								<input name="Img" v-on:change="previewImage" type="file" id="fileuplode">
							</div>
						</div>
					</div>

					<div class="imgPreview">
						<i v-if="!uplodaImgPreview.preview" class='bx bx-image-add icon'></i>
						<img v-if="uplodaImgPreview.preview" :src="uplodaImgPreview.preview" width="400px" alt="">
					</div>
					<div class="modal-footer">
						<button type="button" class="btn btn-warning" @@click="cancel">取消</button>
						<button type="button" class="btn btn-success" @@click="EditAnnouncement(item)">修改</button>
					</div>
				</div>
			</div>
		</div>
	</div>
	<!-- 新增Modal -->
	<div class="modal fade" id="staticBackdrop" data-bs-backdrop="static" data-bs-keyboard="false" tabindex="-1" aria-labelledby="staticBackdropLabel" aria-hidden="true">
		<div class="modal-dialog modal-xl modal-dialog-centered">
			<div class="modal-content">
				<div class="modal-header">
					<h1 class="modal-title fs-5" id="staticBackdropLabel">新增</h1>
					<button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
				</div>
				<div class="modal-body container text-center">
					<div class="row row-cols-lg-auto g-4 align-items-center">
						<div class="col-3">
							<div class="input-group">
								<div class="input-group-text">類型選擇:</div>
								<select name="Type" class="form-control form-control-lg" aria-label=".form-control-lg example" v-model="createInfo.Type">
									<option value="首頁">首頁</option>
									<option>輪播圖</option>
									<option>優惠公告</option>
									<option>熱賣</option>
								</select>
							</div>
						</div>
						<div class="col-3">
							 <div class="input-group">
								<div class="input-group-text">內容描述:</div>
									<input name="Context" class="form-control form-control-lg" type="text" placeholder="輸入內容" aria-label=".form-control-lg example" v-model="createInfo.Context">
							 </div>
						</div>
						<div class="col-2">
							<label class="input-group-text form-check-label" for="flexSwitchCheckDefault">切換上下架:</label>
						</div>
						<div class="col-2">
							<div class="form-check form-switch">								
								<input class="form-check-input" type="checkbox" role="switch" id="flexSwitchCheckDefault" v-model="createInfo.Status" style="transform: scale(2)">
							</div>
						</div>
						<div class="col-2">
							<div class="input-group">
								<div class="input-group-text">建立者:</div>
								<input name="Context" class="form-control form-control-lg" type="text" placeholder="輸入管理員名稱" aria-label=".form-control-lg example" v-model="createInfo.Creater">
							</div>
						</div>
						<div class="col-3">
							<div class="input-group">
								<label class="input-group-text" name="Img">上傳圖片:</label>
								<input name="Img" v-on:change="previewImage" type="file" id="fileInput">
							</div>
						</div>
					</div>
				
					<div class="imgPreview">
						<i v-if="!uplodaImgPreview.preview" class='bx bx-image-add icon'></i>
						<img v-if="uplodaImgPreview.preview" :src="uplodaImgPreview.preview" width="400px" alt="">
					</div>
					<div class="modal-footer">
						<button type="button" class="btn btn-dark" data-bs-dismiss="modal">關閉</button>
						<button type="button" class="btn btn-success" @@click="CreateAnnouncement">建立</button>
					</div>
				</div>
			</div>
		</div>
	</div>
</main>

@section Scripts {
	<script src="~/js/vue.js"></script>
	<script src="~/js/announcement.js"></script>
	<script src="~/axios/axios.min.js"></script>
}
